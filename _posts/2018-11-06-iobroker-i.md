---
layout: post
title: "Установка ioBroker на ОС Linux "
date:   2018-11-06
description: "Установка ioBroker на ОС Linux"
categories: ioBroker
main-class: 'iobroker'
color: '#EB7728'
tags:
- iobroker
- iob
- иоброкер
- иоб
- Linux 
excerpt:
introduction: "❗️ Установка ioBroker на ОС Linux"
---
![][3]
# Установка ioBroker на  OC Linux
**Всем привет!**
>У многих возникает проблема с первой установкой ioBroker на ПК/Одноплатник (она-же Raspberry/Малина к ним-же относятся оранджы,
 бананы и т.д.))) под операционной системой Linux. В этой статье пройдём по основным пунктам которые будут актуальны практически
 в любой сборке Линукс
 
>Установку из под Windows в этой статье рассматривать не буду так-как Windows операционка сама по себе очень прожорливая,
а нам дороги каждый МБ оперативнной памяти, конечно ioBroker на Windows имеет место быть если у вас позволяет железо,
а с Linux ну прям совсем туго.

>И так, устанавливаем на ПК/Лептоп/Малинку понравившуюся сборку Линукс или используем уже имеющуюся.
 Для ПК/Лептоп я бы посоветовал (и дальше в статье её буду использовать) сборку [Linux Mint 19][1]

Для Малинки (или другого одноплатника)  [DietPi][2]  но это не принципиально ?
Саму установку ОС опустим, она расписанна уже сотни раз

## Начнём :)

**У НАС УСТАНОВЛЕН ЛИНУКС И ИМЕЕТСЯ ДОСТУП К СИСТЕМЕ ПО SSH**

Первым делом приведём нашу ОС в актуальное состояние

{% highlight bash %}
sudo apt-get update
sudo apt-get upgrade
{% endhighlight %}

ожидаем завершения, на одноплатниках это может занять определённое колличество времени.
Удаляем если уже была в системе установленна ранее или прилогалась в сборке ОС ноду.
Просто строку за строкой отрабатываем следущие команды
Входим с правами root (или перед всеми командами добавляем команду sudo)

{% highlight bash %}
sudo su
apt-get --purge remove node
apt-get --purge remove nodejs
apt-get autoremove
reboot
{% endhighlight %}

Устанавливаем ноду 8 и несколько необходимых пакетов

{% highlight bash %}
sudo su
apt-get install curl
curl -sL https://deb.nodesource.com/setup_8.x | bash -
apt-get install -y nodejs
apt-get install git-core libnss-mdns libavahi-compat-libdnssd-dev -y
apt-get install -y libudev-dev libpam0g-dev
apt-get install build-essential libpcap-dev -y
npm install -g node-gyp
npm install -g npm@latest
{% endhighlight %}

Проверяем всё ли правильно установилось командами

{% highlight bash %}
node -v
npm -v
{% endhighlight %}

должны увидеть вывод примерно как на скрине ниже (версии актуальны на 1.11.2018)

![][4]

Выходим из root командой exit

Установим serialport, он может нам пригодится в будущем кто использует стики zigbee, z-wave и т.д.
{% highlight bash %}
sudo npm install -g serialport --unsafe-perm
{% endhighlight %}

Командой serialport-list выводим имеющиеся сериальные порты и что в них установлено

{% highlight bash %}
serialport-list
{% endhighlight %}

![][5]


**Подготовка к установке ioBroker закончена, переходим непосредственно к самой установке ioBroker**
 (все команды отрабатываем построчно)
 
 {% highlight bash %}
sudo su
cd /opt
mkdir iobroker
cd iobroker
npm install iobroker --unsafe-perm
{% endhighlight %}



**Готово❗️**

Запоминаем что всё что делаем с ioBroker делаем из директории /opt/iobroker

Соответственно переход у нас такой

{% highlight bash %}
cd  /opt/iobroker
{% endhighlight %}

Базовые команды

{% highlight bash %}
sudo iobroker start
sudo iobroker stop
sudo iobroker restart
{% endhighlight %}

Больше узнать о доступных командах можем командой 

{% highlight bash %}
iobroker -h
{% endhighlight %}

Командой iobroker start  запускаем iobroker и он должен будет доступен по адресу из браузера
{% highlight html %}
http://ип_вашей_системы:8081
{% endhighlight %}

![][6]

После того как был выбран язык нажимаем на «согласен» с лицензионным сглашением.
Автоматически запустится визард предустановленного драйвера „discovery“, здесь вносим своё место нахождения (или примерное место) для корректного определения восхода/заката солнца, это также можно сделать позже в админке нажав на гаечный ключ вверху страницы.

![][7]

Нажав сохранить и дальше мы попадем на страничку с чекбоксами которые помогут отсканировать вашу колальную сеть и выявить имеющиеся устройства на первичном уровне.
(Сканирование производить не обязательно)
Нажимаем на поиск либо на закрыть для выхода из Визарда.
Рассмотрим настройки админки (гайечный ключь вверху страницы)
Задесь мы снова имеем возможность занести или скорректировать наши георасположение, а так-же выбрать репозиторий обновления драйверов.

**Default**–стабильные/проверенные версии

**Latest** – версии драйверов находящиеся в стадии тестирования

Я выбираю «Latest» 

![][8]

В вкладке Репозитории адреса тех самых default и latest с первой страницы. При необходимости здесь можно отредактировать или добавить свои (для продвинутых пользователей)
Остальные вкладки для начинающих пользователей не важны.
Треугольник в левом верхнем углу открывает выподающие меню с выбором вкладок левой части страницу. У некоторых драйверов есть своя вкладка, здесь можно их скрыть или на оборот активировать если вы часто ими пользуетесь

![][9]

Вкладка настройка отображет установленные драйверы, в нашем случаи здесь админка и драйвер дискавери. Режим «Эксперта» открывает дополнительные возможности.
На пример в столбике «Перезапустить» можно управлять перезапуском драйвера по определённому отрезку времени. 

![][10]

Столебц «Уровень» отвечает за уровень логирования драйвера, к примеру мы можем выставить какую информацию драйвер должен логировать. Уровень debug  будет выводить всю доступную информацию

![][11]

Лог можно посмотреть в вкладке Лог в левой колонке. При необходимости скачать/сохранить лог тапнув на «Скачать журнал». Меню фильтров интуитивно понятно, фильтруем что мы хотим видеть в логе.

![][12]

В вкладке «Объекты» имеем непосредственный доступ ко всем объектам системы и драйверов. (На этом этапе пока пропустим детальное рассмотрение)

![][13]

Попробуем установить один драйвер. Для этого переходим в вкладку «Драйвера»
Циферка «2» на менюшке вкладки говорит нам о том что доступны 2 драйвера к обновлению.
Режим эксперта открывает нам расширенный доступ к меню.

![][14]

Эта кнопка отсортирует и оставит только драйверы имеющие доступное обновление.

![][15]

Этой кнопкой мы обновляем драйвер

![][16]

Снова выключаем кнопку отображения драйвера с доступным обновлением чтоб показать полный список доступных драйверов админки из репозитория „Latest“.
Мы можем просто искать нужный нам драйвер или воспользоваться фильтром, например установим драйвер „Javascript“.

![][17]

Фильтр отсортирует по фразе в полепоиска, плюсиком мы установим необходимый драйвер, знак вопроса «?» покажет информацию о драйвере и информацию обновлений.

![][18]

На самом деле есть несколько способов установки драйверов, для продвинутых пользователей есть возможность установки через командную строку или ссылкой Github в меню админки
Пример установки (для продвинутых пользователей)

![][19]

На пример для установки адаптера яваскрипт с гитхаб нам понадобится этот адрес

![][20]

[1]: https://linuxmint.com/
[2]: https://dietpi.com/
[3]: /assets/image/intro_iob.png
[4]: /assets/image/node_v.png
[5]: /assets/image/serialport.png
[6]: /assets/image/admin_st.png
[7]: /assets/image/alex/4.png
[8]: /assets/image/alex/5.png
[9]: /assets/image/alex/6.png
[10]: /assets/image/alex/7.png
[11]: /assets/image/alex/8.png
[12]: /assets/image/alex/9.png
[13]: /assets/image/alex/10.png
[14]: /assets/image/alex/11.png
[15]: /assets/image/alex/12.png
[16]: /assets/image/alex/13.png
[17]: /assets/image/alex/14.png
[18]: /assets/image/alex/15.png
[19]: /assets/image/alex/16.png
[20]: /assets/image/alex/17.png
