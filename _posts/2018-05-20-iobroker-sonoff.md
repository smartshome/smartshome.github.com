---
layout: post
title: "ioBroker –∏ Sonoff"
date:   2018-03-07
description: "ioBroker –∏ Sonoff"
categories: ioBroker
main-class: 'iobroker'
color: '#EB7728'
tags:
- iobroker
- iob
- –∏–æ–±—Ä–æ–∫–µ—Ä
- –∏–æ–±
- sonoff 
excerpt:
introduction: "–î–µ–ª–∞–µ–º –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —É–º–Ω—ã–π –¥–æ–º –Ω–∞ –±–∞–∑–µ ioBroker –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ Sonoff"
---

# –î–µ–ª–∞–µ–º –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π —É–º–Ω—ã–π –¥–æ–º –Ω–∞ –±–∞–∑–µ ioBroker –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ Sonoff

–¶–µ–ª–∏:

1. –ü–æ–ª—É—á–∏—Ç—å —Ä–∞–±–æ—Ç–∞—é—â–∏–π –±–µ–∑ –≤—Å—è—á–µ—Å–∫–∏—Ö –æ–±–ª–∞—á–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–≥–∏–π –∏ –¥–æ—Å—Ç—É–ø–∞ –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–∏—Å—Ç–µ–º—É —É–º–Ω–æ–≥–æ –¥–æ–º–∞.
2. –û–±–æ–π—Ç–∏—Å—å –º–∏–Ω–∏–º—É–º–æ–º –¥–µ–Ω–µ–≥.
3. –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –º–∏–Ω–∏–º—É–º–æ–º –≥–µ–º–æ—Ä—Ä–æ—è.

–ß–µ–º –±—É–¥–µ–º —É–ø—Ä–∞–≤–ª—è—Ç—å:

1. –°–≤–µ—Ç–æ–º.
2. –ö–æ—Ç–ª–∞–º–∏.
3. –í–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º.

–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

1. IOS
2. Android

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ ioBroker

–í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ Raspberry Pi 3 model B, —Ç–∞–∫ –∫–∞–∫ –æ–±–ª–∞–¥–∞–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –û–ó–£, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è –∏ –≤–µ—Å—å–º–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –≤ –ø—Ä–æ–¥–∞–∂–µ.

–¢–∞–∫ –∫–∞–∫ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —Å–ª–æ–∂–∏–ª–æ—Å—å, —á—Ç–æ –ø–æ—á—Ç–∏ –≤—Å–µ –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏ ioBroker –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –Ω–∞ Debian, —Ç–æ –Ω–µ –±—É–¥–µ–º –æ—Ç—Ö–æ–¥–∏—Ç—å –æ—Ç —ç—Ç–æ–≥–æ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏–º Raspbian. –ú–æ–∂–Ω–æ –¥–∞–∂–µ –Ω–µ –∑–∞–º–æ—Ä–∞—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ –≤—ã–ø—É—Å–∫, —Ö–æ—Ç—å –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞–ø–∏—Å–∞–Ω—ã –¥–ª—è –≤—ã–ø—É—Å–∫–∞ Jessie, –º—ã –º–æ–∂–µ–º —Å —Ç–µ–º –∂–µ —É—Å–ø–µ—Ö–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ Stretch. –£—Å—Ç–∞–Ω–æ–≤–∫—É –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞ —è –æ–ø–∏—Å—ã–≤–∞—Ç—å –Ω–µ –±—É–¥—É, –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ –∏ —Ç–∞–∫ –ø–æ–ª–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–π, –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å.

ioBroker –∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —á—É—Ç—å –º–µ–Ω–µ–µ –æ—á–µ–≤–∏–¥–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º. –î–ª—è –Ω–∞—á–∞–ª–∞, –ø–æ—á–∏—Å—Ç–∏–º –Ω–∞—à Raspbian –æ—Ç –Ω–µ–Ω—É–∂–Ω–æ–≥–æ –º—É—Å–æ—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, X11:

{% highlight bash %}
apt-get remove --auto-remove --purge &#39;libx11-.\*&#39;
apt-get autoremove ‚Äìpurge
{% endhighlight %}

–í—Ç–æ—Ä–æ–π –ø—É–Ω–∫—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å –ø–æ–∫–∞ apt –Ω–µ —Å–∫–∞–∂–µ—Ç —á—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–µ—á–µ–≥–æ.
–ó–∞—Ç–µ–º –ø–æ—á–∏—Å—Ç–∏–º –µ–≥–æ –æ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–π —Å–±–æ—Ä–∫–∏ NodeJS (–ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–∞ –≤–∞–Ω–∏–ª—å–Ω–∞—è):

{% highlight bash %}
apt-get --purge remove node
apt-get --purge remove nodejs
apt-get autoremove ‚Äìpurge
{% endhighlight %}

4. –ü–æ–≤—Ç–æ—Ä—è—Ç—å –ø–ø. 3 –ø–æ–∫–∞ apt –Ω–µ —Å–∫–∞–∂–µ—Ç —á—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–µ—á–µ–≥–æ.
5. reboot


–í—Ö–æ–¥–∏–º –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ–¥ root –∏ —Å—Ç–∞–≤–∏–º NodeJS:

1. curl -sL [https://deb.nodesource.com/setup\_6.x](https://deb.nodesource.com/setup_6.x) | sudo -E bash -
2. apt-get install -y build-essential python-rpi.gpio python nodejs
3. reboot

–í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ: –ø–æ—Å–∫–æ–ª—å–∫—É –º—ã –∂–∏–≤—ë–º –≤ –†–æ—Å—Å–∏–∏, —Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –±—É–π—Å—Ç–≤—É—é—â–∏–π –†–æ—Å–∫–æ–º–Ω–∞–¥–∑–æ—Ä, –ø–æ—ç—Ç–æ–º—É, –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–¥—ë—Ç—Å—è –ø–æ–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é cURL, —á—Ç–æ–±—ã –Ω–∞–º –Ω–µ —Å—ã–ø–∞–ª–æ 451 –æ—à–∏–±–∫–æ–π –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —á—Ç–æ-—Ç–æ —Å–∫–∞—á–∞—Ç—å. –°–æ–∑–¥–∞—ë–º ~/.curlrc –∏ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –≤ –Ω–µ–≥–æ proxy = http://username:password@proxy-host:port, –º–µ–Ω—è—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –≤–∞—à–∏.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ ioBroker:

1. mkdir /opt/iobroker
2. chmod 777 /opt/iobroker
3. cd /opt/iobroker
4. npm install iobroker --unsafe-perm

–¢–µ–ø–µ—Ä—å ioBroker –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ 8081TCP –ø–æ—Ä—Ç—É. –ù–µ –∑–∞–±—É–¥—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π IP-–∞–¥—Ä–µ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ! –õ–∏–±–æ static DHCP lease, –ª–∏–±–æ –≤ /etc/dhcpcd.conf. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –µ–≥–æ, –æ–Ω –¥–∞–ª—å—à–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

–¢–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –Ω–µ –∑–∞–±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—å —Ç—Ä–æ–π–∫—É –ø–æ—Ä—Ç–æ–≤:
iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 8081 -j ACCEPT
iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 8082 -j ACCEPT
iptables -A INPUT -m state --state NEW -m tcp -p tcp --dport 1883 -j ACCEPT

–ò –∑–∞–æ–¥–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º —ç—Ç–∏ —Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏ –≤ /etc/rc.local, —á—Ç–æ–±—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Ä—Ç—ã –Ω–µ –æ—Å—Ç–∞–ª–∏—Å—å –∑–∞–∫—Ä—ã—Ç—ã–º–∏.

## –†–∞–∑–±–∏—Ä–∞–µ–º—Å—è —Å Sonoff

–ë—ã–ª–∏ –∑–∞–∫—É–ø–ª–µ–Ω—ã Sonoff Basic –∏ Sonoff TH16. –û–±–∞ —ç—Ç–∏—Ö &quot;Wi-Fi smart switch&quot; –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ ESP8266EX –∏ –∏–º–µ—é—Ç –Ω–∞ –±–æ—Ä—Ç—É 8 –º–µ–≥–∞–±–∏—Ç —Ñ–ª–µ—à-–ø–∞–º—è—Ç–∏ (1 –º–µ–≥–∞–±–∞–π—Ç). GPIO, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–∞–º –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

- GPIO0 - –∫–Ω–æ–ø–∫–∞
- GPIO12 - —Ä–µ–ª–µ
- GPIO13 - —Å–≤–µ—Ç–æ–¥–∏–æ–¥
- GPIO14 - –Ω–∞ Sonoff Basic –Ω–µ –∑–∞–Ω—è—Ç, –Ω–∞ Sonoff TH16 —ç—Ç–æ 2.5 –º–º jack –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–∞—Ç—á–∏–∫–∞, AM2301, –Ω–∞–ø—Ä–∏–º–µ—Ä.

–ü—Ä–æ—à–∏–≤–∫–∞, –ø—É—Ç—ë–º —Å—Ç—Ä–∞–¥–∞–Ω–∏—è –∏ –ø—Ä–æ–±, –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ ESPEasy mega-20180505 ( [https://github.com/letscontrolit/ESPEasy/releases/tag/mega-20180505](https://github.com/letscontrolit/ESPEasy/releases/tag/mega-20180505)), –∫–∞–∫ –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–∞—è. –ü—Ä–æ—à–∏–≤–∞—Ç—å –º—ã –µ—ë –±—É–¥–µ–º —á–µ—Ä–µ–∑ UART (–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ USART, –Ω–æ –∫–æ–≥–æ —ç—Ç–æ –≤–æ–ª–Ω—É–µ—Ç?). –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–æ—à–∏–≤–∞–ª—å—â–∏–∫–∞ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª esptool.py, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ –º–æ—ë–º —Ö–æ—Å—Ç–µ —Å Arch Linux –æ–Ω –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –∏ –±–µ–∑ –ø–æ–º–µ—Ö —É—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Å –ø–æ–º–æ—â—å—é yaourt –∏–∑ AUR.

–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–∏–Ω–æ–≤ –¥–ª—è –ø—Ä–æ—à–∏–≤–∫–∏ –¥–∏—Å–ª–æ—Ü–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –≥–ª–∞–∑, –Ω–æ –æ–ø–∏—à—É –¥–ª—è –Ω–µ –æ—á–µ–Ω—å –ø—Ä–æ–∑–æ—Ä–ª–∏–≤—ã—Ö:

Sonoff TH16 - –≤ –¥–∞–ª—å–Ω–µ–º –æ—Ç –ø–∏—Ç–∞–Ω–∏—è —É–≥–ª—É –ø–ª–∞—Ç—ã –ø—Ä—è–º–æ –ø–æ–¥–ø–∏—Å–∞–Ω—ã VCC, Tx, Rx –∏ GND.

Sonoff Basic - –ø—è—Ç—å –ø—è—Ç–∞–∫–æ–≤ —Å –æ—Ç–≤–µ—Ä—Å—Ç–∏—è–º–∏ –º–µ–∂–¥—É –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä–æ–º, –∫–Ω–æ–ø–∫–æ–π –∏ —Ñ–ª–µ—à-–ø–∞–º—è—Ç—å—é. –ü–µ—á–∞—Ç—å—é –Ω–∞ —Ç–µ–∫—Å—Ç–æ–ª–∏—Ç–µ –æ–Ω–∏ –æ–±–≤–µ–¥–µ–Ω—ã –≤ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫, –±–ª–∏–∂–∞–π—à–∏–π –∫ –∫–Ω–æ–ø–∫–µ –æ–±–≤–µ–¥—ë–Ω –≤ –∫–≤–∞–¥—Ä–∞—Ç. –ù–∞—á–∏–Ω–∞—è —Å –∫–≤–∞–¥—Ä–∞—Ç–∞: VCC, Tx, Rx, GND, GPIO14.

VCC —á—Ç–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ - 3.3 –≤–æ–ª—å—Ç–∞. –í–∞–∂–Ω–æ: –ø–∏—Ç–∞–Ω–∏–µ –∏–∑ —Ä–æ–∑–µ—Ç–∫–∏ –≤—ã—Ç–∞—Å–∫–∏–≤–∞–µ–º, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å VCC –æ—Ç USB-to-UART, –ø–æ—Ç–æ–º—É —á—Ç–æ –≥–∞–ª—å–≤–∞–Ω–∏—á–µ—Å–∫–æ–π —Ä–∞–∑–≤—è–∑–∫–∏ –Ω–∞ –ø–ª–∞—Ç–µ –Ω–µ—Ç –∏ –≤—ã —Å–æ–∂–≥—ë—Ç–µ –∫ —Ö–µ—Ä—è–º —Å–≤–æ–π Sonoff, USB-to-UART, –∞ –µ—Å–ª–∏ –Ω–µ –ø–æ–≤–µ–∑—ë—Ç, —Ç–æ –∏ –ø–æ—Ä—Ç—ã –Ω–∞ –º–∞—Ç–µ—Ä–∏–Ω–∫–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.

–í –∫–∞—á–µ—Å—Ç–≤–µ USB-to-UART —è –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é PL2303HX, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –∑–∞—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–ª —Å–µ–±—è –∑–∞ 15 –ª–µ—Ç –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–Ω–æ–π.

–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ—à–∏–≤–∫–∏ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç, –Ω–æ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä—É–∫–∞–º–∏ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. USB-to-UART –ø–æ–¥–∫–ª—é—á–∞–µ–º –∫ Sonoff, –Ω–æ –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º –∫ USB –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.
2. –í–≤–æ–¥–∏–º –∫–æ–º–∞–Ω–¥—É –¥–ª—è –ø—Ä–æ—à–∏–≤–∫–∏, –Ω–µ –Ω–∞–∂–∏–º–∞—è enter. –¢–æ –µ—Å—Ç—å –≥–æ—Ç–æ–≤–∏–º –µ—ë –∫ –∑–∞–ø—É—Å–∫—É –ø–æ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–µ.
3. –í—Å—Ç–∞–≤–ª—è–µ–º USB-to-UART –≤ USB –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –Ω–µ –±—ã–ª –ø–æ–¥–∫–ª—é—á–µ–Ω, –Ω–æ —á—Ç–æ–±—ã –≤—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –¥–æ –∫–æ–Ω—Ü–∞ –æ–¥–Ω–æ–π —Ä—É–∫–æ–π –Ω–µ —Å–æ—Å—Ç–∞–≤–ª—è–ª–æ –ø—Ä–æ–±–ª–µ–º—ã. –¢—É—Ç –≤–∞–º –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è USB —É–¥–ª–∏–Ω–∏—Ç–µ–ª—å.
4. –ó–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ Sonoff.
5. –ê —Ç–µ–ø–µ—Ä—å –¥–µ–π—Å—Ç–≤—É–µ–º –±—ã—Å—Ç—Ä–æ: –Ω–µ –æ—Ç–ø—É—Å–∫–∞—è –∫–Ω–æ–ø–∫—É –Ω–∞ Sonoff, –≤—Å—Ç–∞–≤–ª—è–µ–º –¥–æ –∫–æ–Ω—Ü–∞ USB, –∂–º—ë–º Enter, –∂–¥—ë–º –ø–æ–∫–∞ –ø–æ–π–¥—ë—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ—à–∏–≤–∫–∏, –æ—Ç–ø—É—Å–∫–∞–µ–º –∫–Ω–æ–ø–∫—É Sonoff.

–ê —Ç–µ–ø–µ—Ä—å –∫–æ–º–∞–Ω–¥—ã:

1. –ß–∏—Ç–∞–µ–º, —á—Ç–æ –º—ã –≤–æ–æ–±—â–µ –ø–æ–¥–∫–ª—é—á–∏–ª–∏ (–º–∞–ª–æ –ª–∏ —á–µ–≥–æ –∫–∏—Ç–∞–π—Ü—ã –º–æ–≥–ª–∏ –Ω–∞—Å–æ–≤–∞—Ç—å):

sudo esptool --port /dev/ttyUSB0 --baud 115200 chip\_id

1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –∑–∞ —Ñ–ª–µ—à —É –Ω–∞—Å, –∫–æ–º–∞–Ω–¥—ã –æ—Ç—Å—é–¥–∞ –∏ –¥–∞–ª—å—à–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∏–∑ —Ä–∞—Å—á—ë—Ç–∞ —á—Ç–æ —É –Ω–∞—Å ESP8266\*:

sudo esptool --port /dev/ttyUSB0 --baud 115200 --chip esp8266 flash\_id

1. –ß–∏—Ç–∞–µ–º MAC-–∞–¥—Ä–µ—Å, –µ—Å–ª–∏ –≤—ã –ª—é–±–∏—Ç–µ static leases –≤ DHCP-—Å–µ—Ä–≤–µ—Ä–µ –≤–∞—à–µ–≥–æ –º–∞—Ä—à—É—Ç–∏–∑–∞—Ç–æ—Ä–∞:

sudo esptool --port /dev/ttyUSB0 --baud 115200 --chip esp8266 read\_mac

1. –ë—ç–∫–∞–ø–∏–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–ª–µ—à-–ø–∞–º—è—Ç–∏, –Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è, –∫–æ–º–∞–Ω–¥—ã –æ—Ç—Å—é–¥–∞ –∏ –¥–∞–ª—å—à–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∏–∑ —Ä–∞—Å—á—ë—Ç–∞ —á—Ç–æ —É –Ω–∞—Å —Ñ–ª–µ—à –Ω–∞ 1 –º–µ–≥–∞–±–∞–π—Ç:

sudo esptool --port /dev/ttyUSB0 --baud 115200 --chip esp8266 read\_flash 0 0x100000 Sonoff\_TH1016-2.1.bin

1. –í—ã—Ç–∏—Ä–∞–µ–º —Ñ–ª–µ—à FF–∞–º–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤—Å—è–∫–æ–≥–æ –º—É—Å–æ—Ä–∞:

sudo esptool --port /dev/ttyUSB0 --baud 115200 --chip esp8266 erase\_flash

1. –ê —Ç–µ–ø–µ—Ä—å —à—å—ë–º—Å—è. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∏–º—è —Ñ–∞–π–ª–∞ –ø—Ä–æ—à–∏–≤–∫–∏! –ù–∞–º –Ω—É–∂–Ω—ã –∏–º–µ–Ω–Ω–æ –æ–±—Ä–∞–∑ normal –∏ –Ω–∞ 1024 –∫–∏–ª–æ–±–∞–π—Ç–∞ —Ñ–ª–µ—à-–ø–∞–º—è—Ç–∏:

sudo esptool --port /dev/ttyUSB0 --baud 115200 --chip esp8266 write\_flash 0 ~/Downloads/ESPEasy\_mega-20180505/ESP\_Easy\_mega-20180505\_normal\_ESP8266\_1024.bin

–ó–∞—Ç–µ–º –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å Sonoff –æ—Ç UART, —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø–∏—Ç–∞—Ç—å –≤–∏–ª–∫–æ–π –æ—Ç —Ä–æ–∑–µ—Ç–∫–∏.

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è —É –Ω–∞—Å –≤ —ç—Ñ–∏—Ä–µ Wi-Fi 2.4 –ì–ì—Ü –ø–æ—è–≤–∏—Ç—Å—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —Å SSID ESP\_Easy\_0, –ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –Ω–µ–π —Å –ø–∞—Ä–æ–ª–µ–º configesp –∏ DHCP –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –í —Å–∏–ª—É –∫–∞–∫–∏—Ö-—Ç–æ —Å—Ç—Ä–∞–Ω–Ω–æ—Å—Ç–µ–π, –ª–∏—á–Ω–æ —É –º–µ–Ω—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ —ç—Ç–æ–π —Ç–æ—á–∫–µ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–æ—Ö–æ–¥–∏–ª–∞ —Ç–æ–ª—å–∫–æ —Å–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞ –Ω–∞ Android 7.1. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞ [http://192.168.4.1/](http://192.168.4.1/) –∏ –≤—ã–±–∏—Ä–∞–µ–º SSID —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–ª–∞–Ω–∏—Ä—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–º–Ω–æ–≥–æ –¥–æ–º–∞. –¢–∞–º –∂–µ –≤–≤–æ–¥–∏–º –ø–∞—Ä–æ–ª—å, —Å–æ—Ö—Ä–∞–Ω—è–µ–º—Å—è, –∂–¥—ë–º 20 —Å–µ–∫—É–Ω–¥, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º Sonoff –ø–æ –ø–∏—Ç–∞–Ω–∏—é –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ IP-–∞–¥—Ä–µ—Å Sonoff, –∫–æ—Ç–æ—Ä—ã–π —É –Ω–∞—Å –æ—Ç–æ–±—Ä–∞–∑–∏–ª—Å—è –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ (–∏–ª–∏ –∂–µ –≤—ã —Å–¥–µ–ª–∞–ª–∏ static lease —É DHCP –∑–∞—Ä–∞–Ω–µ–µ, –≤–µ—Ä–Ω–æ?).

–°–æ–≤–µ—Ç: –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å Rx, Tx –∏ GND USB-to-UART –∫ Sonoff (–≥–ª–∞–≤–Ω–æ–µ VCC –Ω–µ –ø–æ–¥–∫–ª—é—á–∞—Ç—å) –∏ —Å–º–æ—Ç—Ä–µ—Ç—å –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –ü–ö, —á—Ç–æ –æ–Ω –Ω–∞–º –≥–æ–≤–æ—Ä–∏—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, IP-–∞–¥—Ä–µ—Å –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ç–æ—á–∫–µ. –Ø –ª–∏—á–Ω–æ —Å–º–æ—Ç—Ä–µ–ª —ç—Ç–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ sudo minicom -D /dev/ttyUSB0.

–ü—Ä–∏—Å—Ç—É–ø–∞–µ–º –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –Ω–∞—à–µ–≥–æ Sonoff.

1. –ú–µ–Ω—è–µ–º –∏–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–∞ –Ω–∞—à–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, Sonoff1. –î–µ–ª–∞–µ—Ç—Å—è —ç—Ç–æ –≤ Config -&gt; Main settings -&gt; Unit name.
2. –ó–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–æ–∏–º –∫–ª–∏–µ–Ω—Ç MQTT –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –Ω–∞—à Sonoff –±—É–¥–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å ioBroker: Controllers -&gt; Edit —Å–∞–º—ã–π –ø–µ—Ä–≤—ã–π –≤ —Å–ø–∏—Å–∫–µ -&gt;

-
  - –≤ Protocol –≤—ã–±–∏—Ä–∞–µ–º OpenHAB MQTT
  - Locate controller ‚Äì Use IP-address
  - Controller IP - –≤–ø–∏—Å—ã–≤–∞–µ–º IP-–∞–¥—Ä–µ—Å Raspberry, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –º—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ ioBroker
  - Controller port ‚Äì 1883
  - Controller User ‚Äì mqtt
  - Controller Password ‚Äì mqtt
  - Controller subscribe - /Sonoff1/Relay\_sonoff1/Switch
  - Controller publish ‚Äì /Sonoff1/%tskname%/%valname%
  - —Å—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Enable
  - –∂–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit.

1. –ù–∞—Å—Ç—Ä–æ–∏–º –Ω–µ–º–Ω–æ–≥–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –¢–æ—á–Ω–µ–µ, —è –∏—Ö –æ—Ç–∫–ª—é—á–∞—é: Hardware -&gt; GPIO LED -&gt; None (–Ω–µ –ª—é–±–ª—é, —á—Ç–æ–±—ã —á—Ç–æ-—Ç–æ —Å–≤–µ—Ç–∏–ª–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ). –¢–∞–º –∂–µ, –Ω–∏–∂–µ GPIO Switch -&gt; None.
2. –ó–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –Ω–∞—à–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É Devices, –¥–∞–ª—å—à–µ –ø–æ –Ω–æ–º–µ—Ä–∞–º –≤ —Å—Ç–æ–ª–±—Ü–µ Task –Ω–∞–∂–∏–º–∞–µ–º Edit.

1.
  1. –ù–∞—Å—Ç—Ä–æ–∏–º —Ä–µ–ª–µ.
    - Device -&gt; Switch input ‚Äì Switch
    - Name -&gt; Relay\_sonoff1
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Enabled
    - 1st GPIO -&gt; GPIO12
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Send to controller
    - –ñ–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit
  2. –ù–∞—Å—Ç—Ä–æ–∏–º —Å–≤–µ—Ç–æ–¥–∏–æ–¥. –ö—Å—Ç–∞—Ç–∏, –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –Ω–∞ Sonoff TH16 –¥–≤–∞ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞, –∏–∑ ESPEasy –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –æ–¥–∏–Ω.
    - Device -&gt; Switch input ‚Äì Switch
    - Name -&gt; Led\_sonoff1
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Enabled
    - 1st GPIO -&gt; GPIO13
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Send to controller
    - –ñ–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit
  3. –ù–∞—Å—Ç—Ä–æ–∏–º –∫–Ω–æ–ø–∫—É. –ù—É, –º–∞–ª–æ –ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ —á—Ç–æ-—Ç–æ –Ω–∞ —ç—Ç—É –∫–Ω–æ–ø–∫—É –ø–æ—Ç–æ–º –ø–æ–≤–µ—Å–∏—Ç—å.
    - Device -&gt; Switch input ‚Äì Switch
    - Name -&gt; Button\_sonoff1
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Enabled
    - 1st GPIO -&gt; GPIO0
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Send to controller
    - –ñ–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit
  4. –ù–∞—Å—Ç—Ä–æ–∏–º –∏–º–ø–æ—Ä—Ç –Ω–∞—à–∏—Ö –¥–µ–≤–∞–π—Å–æ–≤ –≤ –¥–µ—Ä–µ–≤–æ –¥—Ä–∞–π–≤–µ—Ä–∞ MQTT (—á–∏—Ç–∞–π: —á—Ç–æ–±—ã —Å–µ—Ä–≤–µ—Ä MQTT, –ø—Ä–∏–∫—Ä—É—á–µ–Ω–Ω—ã–π –∫ ioBroker, —Ä–∞–∑–≥–ª—è–¥–µ–ª —ç—Ç–∏ –¥–µ–≤–∞–π—Å—ã):
    - Device -&gt; Generic ‚Äì MQTT Import
    - Name -&gt; mqtt\_import
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Enabled
    - MQTT Topic 1 -&gt; /Sonoff1/Relay\_sonoff1/Switch (—ç—Ç–æ —á–∞—Å—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –ø–æ –æ–±—É—á–µ–Ω–∏—é Sonoff –≤–æ—Å–ø—Ä–∏–∏–º—á–∏–≤–æ—Å—Ç–∏ –∫ —Å–∏–≥–Ω–∞–ª–∞–º –∏–∑ ioBroker)
    - Values -&gt; Name -&gt; 1 -&gt; value1 (—á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É!)
    - –ñ–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit
  5. –ü—É–Ω–∫—Ç –¥–ª—è Sonoff TH16: –ø—Ä–∏–∫—Ä—É—á–∏–≤–∞–µ–º AL2301 - –¥–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏:
    - Device -&gt; Environment - DHT11/12/22 SONOFF2301/7021
    - Name -&gt; Dht\_sonoff1
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Enabled
    - 1st GPIO -&gt; GPIO14
    - DHT Type -&gt; Sonoff am2301
    - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É –Ω–∞ Send to controller
    - Interval -&gt; –∫–∞–∫–æ–π —Ö–æ—Ç–∏–º, —É –º–µ–Ω—è 30 —Å–µ–∫—É–Ω–¥
    - –ñ–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit

1. –¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–µ–º–Ω–æ–∂–∫–æ –∑–∞—Å–∫—Ä–∏–ø—Ç–æ–≤–∞—Ç—å Sonoff, —á—Ç–æ–±—ã –æ–Ω —â—ë–ª–∫–∞–ª —Ä–µ–ª–µ –ø–æ –∫–æ–º–∞–Ω–¥–µ –∏–∑ ioBroker.
  - –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É Tools
  - –í —Ä–∞–∑–¥–µ–ª–µ System –Ω–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É Advanced
  - –°—Ç–∞–≤–∏–º –≥–∞–ª–æ—á–∫—É Rules
  - –õ–∏—Å—Ç–∞–µ–º –≤ —Å–∞–º—ã–π –Ω–∏–∑ –∏ –∂–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit
  - –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É Main –∏ –≤–∏–¥–∏–º, —á—Ç–æ –ø–æ—è–≤–∏–ª–∞—Å—å –≤–∫–ª–∞–¥–∫–∞ Rules
  - –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É Rules
  - –ö–æ–ø–∏—Ä—É–µ–º —Ç—É–¥–∞ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

on mqtt\_import#value1 do

  if [mqtt\_import#value1] = 1

    gpio,13,0

    gpio,12,1

  else

    gpio,13,1

    gpio,12,0

  endif

endon

-
  - –ñ–º—ë–º –∫–Ω–æ–ø–æ—á–∫—É Submit

–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, Sonoff –Ω–∞—Å—Ç—Ä–æ–µ–Ω! Tools -&gt; Reboot –∏ –ø–æ –ø–∏—Ç–∞–Ω–∏—é –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏. –¢–∞–∫ –∂–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏ –¥—Ä—É–≥–∏–µ –¥–∞—Ç—á–∏–∫–∏, –Ω–µ –∑–∞–±—ã–≤–∞—è –º–µ–Ω—è—Ç—å –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤–æ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º —Å–∞–º–æ–º—É –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è –∏ –Ω–µ –¥–∞—Ç—å –∑–∞–ø—É—Ç–∞—Ç—å—Å—è ioBroker.

## –î–æ–ø–∏–ª–∏–≤–∞–µ–º ioBroker

–ö–∞–∫ –Ω–∏ —Å—Ç—Ä–∞–Ω–Ω–æ, –ø—Ä–æ—Ç–æ–∫–æ–ª MQTT —Ö–æ—Ç—å –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –Ω–æ –≤ –Ω—ë–º –µ—Å—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, 0 –∏ 1 –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ false –∏ true —Å–æ–≤—Å–µ–º –Ω–µ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ, —á—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∏–∫–æ–ª–∞—á–∏–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∫–æ—Å—Ç—ã–ª—è. –í–ø—Ä–æ—á–µ–º, —É–≤–∏–¥–∏—Ç–µ –¥–∞–ª–µ–µ –≤—Å—ë —Å–∞–º–∏. –°–æ–≤–µ—Ç: —Å–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤—Å–µ –≤–∞—à–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ Sonoff –ø–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≥–ª–∞–≤–µ, –∞ –∑–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º ioBroker. –ò–Ω–∞—á–µ –≤–æ–∑–º–æ–∂–Ω—ã –≥–ª—é–∫–∏.

–ü–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –Ω–∞–¥–æ –¥–æ–∫–∞—á–∞—Ç—å –∫—É—á—É –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ ioBroker. –î—Ä–∞–π–≤–µ—Ä –≤ –ø–æ–Ω–∏–º–∞–Ω–∏–∏ ioBroker —ç—Ç–æ –º–æ–¥—É–ª—å, –ø–ª–∞–≥–∏–Ω, –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —á—Ç–æ-—Ç–æ —Å —á–µ–º-—Ç–æ –¥–µ–ª–∞—Ç—å. –û—Ç–∫—Ä—ã–≤–∞–µ–º –∞–¥–º–∏–Ω–∫—É ioBroker, –≤–≤–µ–¥—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ [http://ip-—Å–µ—Ä–≤–µ—Ä–∞-ioBroker:8081/](http://ip-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0-ioBroker:8081/) –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É –î—Ä–∞–π–≤–µ—Ä—ã. –ó–∞—Ç–µ–º —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –Ω–∞—à–∞ Raspberry –≤—ã–ø—É—â–µ–Ω–∞ –≤ –±–æ–ª—å—à–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—ã, –Ω–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–æ—á–∫—É —Å–æ —Å—Ç—Ä–µ–ª–æ—á–∫–∞–º–∏ –ø–æ –∫—Ä—É–≥—É –≤ –≤–µ—Ä—Ö–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É –≤–∫–ª–∞–¥–∫–∏ –î—Ä–∞–π–≤–µ—Ä—ã (–∑–∞–ø–æ–º–Ω–∏—Ç–µ, –∫—Å—Ç–∞—Ç–∏, —ç—Ç—É –∫–Ω–æ–ø–∫—É –Ω–∞ –∫–∞–∂–¥–æ–π –≤–∫–ª–∞–¥–∫–µ, –≥–¥–µ –æ–Ω–∞ –µ—Å—Ç—å, –æ–Ω–∞ –µ—â—ë –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –Ω–µ —Ä–∞–∑), –∂–¥—ë–º –ø–æ–∫–∞ –æ–Ω –æ–±–Ω–æ–≤–∏—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤, –∑–∞—Ç–µ–º –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ –ø–æ –æ—á–µ—Ä–µ–¥–∏ –≤–±–∏–≤–∞–µ–º, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –¥—Ä–∞–π–≤–µ—Ä–∞:

1. javascript - –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Å—Ç–∞–≤–ª—è–µ–º –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
2. mqtt - —Å–µ—Ä–≤–µ—Ä/–±—Ä–æ–∫–µ—Ä –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞—à–∏—Ö Sonoff. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–µ–¥—É—é—â–∏–µ:
  1. –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
  2. –¢–∏–ø -&gt; MQTT —Å–µ—Ä–≤–µ—Ä/–±—Ä–æ–∫–µ—Ä
  3. –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -&gt; mqtt
  4. –ü–∞—Ä–æ–ª—å -&gt; mqtt
  5. –û—Å—Ç–∞–ª—å–Ω–æ–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  6. –ñ–º—ë–º –Ω–∞–≤–µ—Ä—Ö—É –∫–Ω–æ–ø–æ—á–∫—É –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤—ã–π—Ç–∏
3. web - –±–∞–∑–æ–≤—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –¥–æ—Å—Ç—É–ø –∫ mobile. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ—Ç–æ–º —Ä–∞–∑–±–µ—Ä—ë—Ç–µ—Å—å, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è.
4. mobile - –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–±–∏–ª—å–Ω–∏–∫–æ–≤ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –≤—ë—Ä—Å—Ç–∫–æ–π. –ù–∞—Å—Ç—Ä–æ–µ–∫ –Ω–µ –∏–º–µ–µ—Ç.

–ú–æ–∂–Ω–æ –∏ –±–æ–ª—å—à–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤, –Ω–æ —ç—Ç–æ —É–∂–µ –µ—Å–ª–∏ —Å–∞–º–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É –û–±—ä–µ–∫—Ç—ã. –ò —Ç—É—Ç —É –Ω–∞—Å –≤–¥—Ä—É–≥ –ø–æ—è–≤–∏—Ç—Å—è –≥—Ä—É–ø–ø–∞ mqtt.0, –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥—É—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞—à–∏ Sonoff! –ï—Å–ª–∏ –Ω–µ –ø–æ—è–≤–∏–ª–∞—Å—å, —Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥—Ä–∞–π–≤–µ—Ä –∫–Ω–æ–ø–æ—á–∫–æ–π –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞–ø—Ä–æ—Ç–∏–≤ –∏–º–µ–Ω–∏ –¥—Ä–∞–π–≤–µ—Ä–∞ mqtt –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–æ–≤.

–ü—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ Sonoff:

1. –í–∫–ª–∞–¥–∫–∞ –û–±—ä–µ–∫—Ç—ã.
2. –û—Ç–∫—Ä—ã–≤–∞—è –ø–∞–ø–æ—á–∫–∏, —Å–ª–µ–¥—É–µ–º –ø–æ –ø—É—Ç–∏ mqtt.0 -&gt; Sonoff1 -&gt; Relay\_sonoff1 -&gt; Switch.
3. –í —Å—Ç—Ä–æ–∫–µ Switch –≤ —Å—Ç–æ–ª–±—Ü–µ –ó–Ω–∞—á–µ–Ω–∏–µ –º–µ–Ω—è–µ–º 0 –Ω–∞ 1. –†–µ–ª–µ –¥–æ–ª–∂–Ω–æ —â—ë–ª–∫–Ω—É—Ç—å! –ï—Å–ª–∏ –Ω–µ —â—ë–ª–∫–Ω—É–ª–æ, –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ Sonoff.

–¢–µ–ø–µ—Ä—å –Ω–∞—á–∏–Ω–∞–µ–º –≤–æ—Ä–æ—á–∞—Ç—å –∫–æ—Å—Ç—ã–ª—è–º–∏:

1. –ñ–º—ë–º –Ω–∞ –∫–Ω–æ–ø–∫—É —Å –∫–∞—Ä–∞–Ω–¥–∞—à–∏–∫–æ–º –Ω–∞–ø—Ä–æ—Ç–∏–≤ Switch, –∫–æ—Ç–æ—Ä—ã–π –º—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–ª–∏.
2. –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É Raw (–≠–∫—Å–ø–µ—Ä—Ç) –≤ –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
3. –ò—â–µ–º —Å—Ç—Ä–æ–∫—É  &quot;common&quot;.
4. –í —ç—Ç–æ–π –≥—Ä—É–ø–ø–µ –∏—â–µ–º —Å—Ç—Ä–æ–∫—É &quot;type&quot; –∏ –º–µ–Ω—è–µ–º –µ—ë –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ &quot;number&quot;, —á—Ç–æ–±—ã –≤ –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å &quot;type&quot;: &quot;number&quot;.
5. –ñ–º—ë–º –∫–Ω–æ–ø–∫—É &quot;–°–æ—Ö—Ä–∞–Ω–∏—Ç—å&quot;.

–ü–æ–≤—Ç–æ—Ä—è–µ–º —ç—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ Sonoff, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –≤ —Å–ø–∏—Å–∫–µ –æ–±—ä–µ–∫—Ç–æ–≤.

–í–æ—Ä–æ—á–∞–µ–º –∫–æ—Å—Ç—ã–ª—è–º–∏ –¥–∞–ª—å—à–µ:

1. –í–∫–ª–∞–¥–∫–∞ –û–±—ä–µ–∫—Ç—ã.
2. –û—Ç–∫—Ä—ã–≤–∞—è –ø–∞–ø–æ—á–∫–∏, —Å–ª–µ–¥—É–µ–º –ø–æ –ø—É—Ç–∏ mqtt.0 -&gt; Sonoff1 -&gt; Relay\_sonoff1
3. –í –≤–µ—Ä—Ö–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É –≤–∫–ª–∞–¥–∫–∏ –∏—â–µ–º –∫–Ω–æ–ø–æ—á–∫—É —Å –ø–ª—é—Å–æ–º. –ñ–º—ë–º.
4. –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –≤ –ø–æ–ª–µ –ò–º—è –ø–∏—à–µ–º Relay
5. –ñ–º—ë–º –°–æ—Ö—Ä–∞–Ω–∏—Ç—å.
6. –¢–µ–ø–µ—Ä—å –∂–º—ë–º –∫–∞—Ä–∞–Ω–¥–∞—à–∏–∫ –Ω–∞–ø—Ä–æ—Ç–∏–≤ —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ Relay
7. –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É Raw (–≠–∫—Å–ø–µ—Ä—Ç) –≤ –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
8. –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –Ω–∞ –±—É–º–∞–∂–∫—É –∑–Ω–∞—á–µ–Ω–∏—è &quot;ts&quot;, &quot;state&quot; –∏ &quot;object&quot;.
9. –£–¥–∞–ª—è–µ–º –≤—Å—ë –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–µ –∏ –≤—Å—Ç–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥, –Ω–µ –∑–∞–±—ã–≤ –∑–∞–º–µ–Ω–∏—Ç—å –≤ –Ω—ë–º –∑–Ω–∞—á–µ–Ω–∏—è ts, object –∏ state –Ω–∞ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –≤–∞–º–∏ –Ω–∞ –±—É–º–∞–∂–∫—É:

{

  &quot;common&quot;: {

    &quot;name&quot;: &quot;/Sonoff1/Relay\_sonoff1/Relay&quot;,

    &quot;role&quot;: &quot;variable&quot;,

    &quot;desc&quot;: &quot;mqtt server variable&quot;,

    &quot;type&quot;: &quot;boolean&quot;,

    &quot;write&quot;: true,

    &quot;read&quot;: true,

    &quot;mobile&quot;: {

      &quot;admin&quot;: {

        &quot;visible&quot;: true,

        &quot;type&quot;: &quot;light&quot;,

        &quot;name&quot;: &quot;–†–µ–ª–µ Sonoff1&quot;

      }

    }

  },

  &quot;native&quot;: {

    &quot;topic&quot;: &quot;Sonoff1/Relay\_sonoff1/Relay&quot;

  },

  &quot;type&quot;: &quot;state&quot;,

  &quot;from&quot;: &quot;system.adapter.mqtt.0&quot;,

  &quot;ts&quot;: 1666666666666,

  &quot;\_id&quot;: &quot;mqtt.0.Sonoff1.Relay\_sonoff1.Relay&quot;,

  &quot;acl&quot;: {

    &quot;object&quot;: 1666,

    &quot;owner&quot;: &quot;system.user.admin&quot;,

    &quot;ownerGroup&quot;: &quot;system.group.administrator&quot;,

    &quot;state&quot;: 1666

  }

}

1. –ü—Ä–æ–±–µ–≥–∞–µ–º—Å—è –ø–æ –∫–æ–¥—É –µ—â—ë —Ä–∞–∑ –≥–ª–∞–∑–∞–º–∏ - –Ω–µ –∑–∞–±—ã–ª–∏ –ª–∏ –Ω–∏—á–µ–≥–æ?
2. –ñ–º—ë–º –∫–Ω–æ–ø–∫—É –°–æ—Ö—Ä–∞–Ω–∏—Ç—å.
3. –í —Å—Ç–æ–ª–±—Ü–µ –ó–Ω–∞—á–µ–Ω–∏–µ –Ω–∞–ø—Ä–æ—Ç–∏–≤ –ø–æ—è–≤–∏–≤—à–µ–≥–æ—Å—è Relay –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —â–µ–ª–∫–Ω—É—Ç—å –∏ —Å–Ω—è—Ç—å –≥–∞–ª–æ—á–∫—É. –ó–∞—Ç–µ–º –Ω–∞–∂–∞—Ç—å –µ—â—ë –º–∞-–∞–ª–µ–Ω—å–∫—É—é –≥–∞–ª–æ—á–∫—É –≤ —É–≥–æ–ª–∫–µ —ç—Ç–æ–≥–æ –ø–æ–ª—è.

–ü—Ä–æ–¥–µ–ª—ã–≤–∞–µ–º —Ä–µ–¥–∞–∫—Ç—É—Ä—É Switch –∏ Relay —Å–æ –≤—Å–µ–º–∏ –≤–∞—à–∏–º–∏ Sonoff, –Ω–µ –∑–∞–±—ã–≤–∞—è –º–µ–Ω—è—Ç—å –Ω–æ–º–µ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–æ –≤—Å–µ—Ö –∫–æ–¥–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤—Å—Ç–∞–≤–ª—è–µ—Ç–µ.

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –∫–æ—Å—Ç—ã–ª—è–º –ø–æ—Å–ª–æ–∂–Ω–µ–µ:

1. –ñ–º—ë–º –∫–∞—Ä–∞–Ω–¥–∞—à–∏–∫ –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É –≤–∫–ª–∞–¥–∫–∏ —Å –∞–¥–º–∏–Ω–∫–æ–π.
2. –ù–∞–∂–∏–º–∞–µ–º –ø–æ—è–≤–∏–≤—à—É—é—Å—è –∫–Ω–æ–ø–∫—É –ü–æ–∫–∞–∑–∞—Ç—å –∏ –≤—ã–±–∏—Ä–∞–µ–º —Ç–∞–º –°–∫—Ä–∏–ø—Ç—ã.
3. –°–Ω–æ–≤–∞ –∂–º—ë–º –Ω–∞ –∫–∞—Ä–∞–Ω–¥–∞—à–∏–∫.
4. –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É –°–∫—Ä–∏–ø—Ç—ã.
5. –í –ø–∞–Ω–µ–ª–∏ —Å–ª–µ–≤–∞ –≤—ã–±–∏—Ä–∞–µ–º common, –∑–∞—Ç–µ–º –≤ –≤–µ—Ä—Ö–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É –∫–Ω–æ–ø–∫–∏ –Ω–∞–∂–∏–º–∞–µ–º —Å–∞–º—É—é –∫—Ä–∞–π–Ω—é—é —Å–ª–µ–≤–∞ –∫–Ω–æ–ø–∫—É —Å –∑–∞–≥–Ω—É—Ç—ã–º –ª–∏—Å—Ç–æ—á–∫–æ–º.
6. –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –≤—ã–±–∏—Ä–∞–µ–º —Ç–∏–ø —Å–∫—Ä–∏–ø—Ç–∞ - JS.
7. –¢–µ–ø–µ—Ä—å –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ: sonoff1\_switch –∏ –≤—Å—Ç–∞–≤–ª—è–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

on(&#39;mqtt.0.Sonoff1.Relay\_sonoff1.Relay&#39;, function (obj) {

    if(getState(&#39;mqtt.0.Sonoff1.Relay\_sonoff1.Relay&#39;).val) {

        log(&#39;–í–∫–ª—é—á–∞–µ–º —Ä–µ–ª–µ Sonoff1...&#39;);

        setState(&quot;mqtt.0.Sonoff1.Relay\_sonoff1.Switch&quot;, 1);

    } else {

        log(&#39;–í—ã–∫–ª—é—á–∞–µ–º —Ä–µ–ª–µ Sonoff1...&#39;);

        setState(&quot;mqtt.0.Sonoff1.Relay\_sonoff1.Switch&quot;, 0);

    }

});

1. –ñ–º—ë–º –∫–Ω–æ–ø–∫—É –°–æ—Ö—Ä–∞–Ω–∏—Ç—å. –í—Å—ë, —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—â–µ–Ω.

–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –º–µ–Ω—è—è –Ω–æ–º–µ—Ä–∞ Sonoff –≤ —Å–∫—Ä–∏–ø—Ç–µ, –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –¥–ª—è –≤—Å–µ—Ö Sonoff, —á—Ç–æ –µ—Å—Ç—å.

–ù–∞ –∫–æ—Å—Ç—ã–ª—è—Ö –∑–∞–∫–æ–Ω—á–∏–ª–∏, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –¥–æ–ø–∏–ª–∏–≤–∞–Ω–∏—é –¥—Ä–∞–π–≤–µ—Ä–∞ mobile.

–ù–∞—Å—Ç—Ä–æ–µ–∫ —É –Ω–µ–≥–æ –Ω–µ—Ç, –Ω–æ —ç—Ç–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –≤–∞—Å –æ–±–º–∞–Ω—ã–≤–∞—Ç—å.

–ù–∞—Å—Ç—Ä–æ–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —ç—Ç–æ —Ç–æ, –Ω–∞ –æ—Å–Ω–æ–≤–µ —á–µ–≥–æ –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å mobile.

1. –ñ–º—ë–º –∫–∞—Ä–∞–Ω–¥–∞—à–∏–∫ –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É –≤–∫–ª–∞–¥–∫–∏ —Å –∞–¥–º–∏–Ω–∫–æ–π.
2. –ù–∞–∂–∏–º–∞–µ–º –ø–æ—è–≤–∏–≤—à—É—é—Å—è –∫–Ω–æ–ø–∫—É –ü–æ–∫–∞–∑–∞—Ç—å –∏ –≤—ã–±–∏—Ä–∞–µ–º —Ç–∞–º –ö–∞—Ç–µ–≥–æ—Ä–∏–∏.
3. –°–Ω–æ–≤–∞ –∂–º—ë–º –Ω–∞ –∫–∞—Ä–∞–Ω–¥–∞—à–∏–∫.
4. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ö–∞—Ç–µ–≥–æ—Ä–∏–∏.
5. –ñ–º—ë–º –Ω–∞ –ø–ª—é—Å–∏–∫ –≤ –≤–µ—Ä—Ö–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É –≤–∫–ª–∞–¥–∫–∏.
6. –ò–º—è –ø–∏—à–µ–º functions, –∑–∞—Ç–µ–º –∫–Ω–æ–ø–∫—É —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å.
7. –ï—â—ë —Ä–∞–∑ –∂–º—ë–º –Ω–∞ –ø–ª—é—Å–∏–∫ –≤ –≤–µ—Ä—Ö–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É –≤–∫–ª–∞–¥–∫–∏.
8. –ù–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –∏–º—è –ø–∏—à–µ–º rooms, –æ–ø—è—Ç—å –∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º.
9. –¢–µ–ø–µ—Ä—å –≤—ã–¥–µ–ª—è–µ–º functions –∏ –≤ –∫–æ–Ω—Ü–µ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ –≤–∏–¥–∏–º –ø–ª—é—Å–∏–∫. –ñ–º—ë–º.
10. –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ —É–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è light –∏ –∂–º—ë–º –°–æ—Ö—Ä–∞–Ω–∏—Ç—å.
11. –°–Ω–æ–≤–∞ –ø–ª—é—Å–∏–∫, —Ç–µ–ø–µ—Ä—å –∏–º—è temperature.
12. –ò –µ—â—ë —Ä–∞–∑, –Ω–∞ —ç—Ç–æ—Ç —Ä–∞–∑ –∏–º—è humidity.
13. –í—ã–¥–µ–ª—è–µ–º rooms –∏ –≤ –∫–æ–Ω—Ü–µ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ –∂–º—ë–º –ø–ª—é—Å–∏–∫.
14. –ü–∏—à–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –∫–æ–º–Ω–∞—Ç—ã, –≥–¥–µ –±—É–¥–µ—Ç –Ω–∞—à–µ —É–ø—Ä–∞–≤–ª—è–µ–º–æ–µ —Ä–µ–ª–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, terrace.
15. –°–Ω–æ–≤–∞ –ø–ª—é—Å–∏–∫, –µ—â—ë –∫–æ–º–Ω–∞—Ç—É, –Ω–∞–ø—Ä–∏–º–µ—Ä, boiler.
16. –©—ë–ª–∫–∞–µ–º –Ω–∞ –Ω–∞–¥–ø–∏—Å—å boiler –≤ —Å—Ç–æ–ª–±—Ü–µ –ò–º—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –Ω–∞ —á—Ç–æ-—Ç–æ –±–æ–ª–µ–µ —É–¥–æ–±–æ—á–∏—Ç–∞–±–µ–ª—å–Ω–æ–µ: –ë–æ–π–ª–µ—Ä–Ω–∞—è.
17. –¢–∞–∫ –º–æ–∂–Ω–æ –ø—Ä–æ–¥–µ–ª–∞—Ç—å —Å–æ –≤—Å–µ–º–∏ –∫–æ–º–Ω–∞—Ç–∞–º–∏.
18. –¢–µ–ø–µ—Ä—å —Ä–∞—Å–∫–∏–¥–∞–µ–º –Ω–∞—à–∏ —Å–≤–∏—Ç—á–∏ –∏ –¥–∞—Ç—á–∏–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º. –í—ã–¥–µ–ª—è–µ–º light –∏ –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏ –±—É–¥–µ—Ç —ç—Ç–∞–∫–∞—è –ø—Ä–æ—à–∏—Ç–∞—è –ø—Ä—É–∂–∏–Ω–æ–π —Å –ª–µ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∫–Ω–∏–∂–∫–∞. –ñ–º—ë–º –Ω–∞ —ç—Ç—É –∫–Ω–æ–ø–∫—É.
19. –í –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –≤ –µ–≥–æ –Ω–∏–∂–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª–µ –¥–∞–≤–∏–º –ø–ª—é—Å–∏–∫ –∏ –≤ –ø–æ—è–≤–∏–≤—à–µ–º—Å—è –æ–∫–Ω–µ –∏—â–µ–º –∫–∞—Ç–∞–ª–æ–≥ mqtt.0
20. –í—ã–±–∏—Ä–∞–µ–º –≤—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–∞–º–∏ Relay, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–µ—Ç–æ–º.
21. –ñ–º—ë–º –í—ã–±—Ä–∞—Ç—å, –∑–∞—Ç–µ–º –û–∫.
22. –¢–µ–ø–µ—Ä—å –≤—ã–±–∏—Ä–∞–µ–º temperature –∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –¥–æ–±–∞–≤–ª—è–µ–º —Ç—É–¥–∞ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É. –ù–∞–ø—Ä–∏–º–µ—Ä, mqtt.0 -&gt; Sonoff1 -&gt; Dht\_sonoff1 -&gt; Temperature.
23. –¢–æ –∂–µ —Å–∞–º–æ–µ –ø—Ä–æ–¥–µ–ª—ã–≤–∞–µ–º —Å humidity (–≤–ª–∞–∂–Ω–æ—Å—Ç—å).
24. –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –∫–æ–º–Ω–∞—Ç–∞–º. –¢–∞–∫ –∂–µ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–∞–∂–¥–æ–π –∫–æ–º–Ω–∞—Ç—ã –≤—Å–µ –¥–∞—Ç—á–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–∞–º –±—É–¥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è.
25. –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–Ω–æ–ø–æ—á–∫–æ–π –≤–≤–µ—Ä—Ö—É.
26. –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –≤–∫–ª–∞–¥–∫—É –û–±—ä–µ–∫—Ç—ã –∏ –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤ –ø–ø. 24 –¥–æ–±–∞–≤–∏–ª–∏ –≤ –∫–æ–º–Ω–∞—Ç—ã, –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å –æ—Ç –≤–∞—Å —É–∫–∞–∑–∞–Ω–∏–µ, –≤ –∫–∞–∫–æ–π –∫–æ–º–Ω–∞—Ç–µ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è. –ò—â–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π Relay –∏ –≤ —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–µ –∫–ª–∏–∫–∞–µ–º –ø–æ —Å—Ç–æ–ª–±—Ü—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –ö–æ–º–Ω–∞—Ç–∞, –≤—ã–±–∏—Ä–∞–µ–º –∫–æ–º–Ω–∞—Ç—É.

–ù—É, —Ç–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –ø–æ—â—ë–ª–∫–∞—Ç—å –∏–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –ø–æ–∑–¥—Ä–∞–≤–ª—è—é! –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ [http://ip\_–∞–¥—Ä–µ—Å\_raspberry:8082/mobile/](http://ip_%D0%B0%D0%B4%D1%80%D0%B5%D1%81_raspberry:8082/mobile/) –∏ —Ç—ã–∫–∞–π—Ç–µ —Å–∫–æ–ª—å–∫–æ –≤–ª–µ–∑–µ—Ç! –¢–æ–ª—å–∫–æ –Ω–µ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ üôÇ

–í–æ–∑–º–æ–∂–Ω–æ, —É –≤–∞—Å –ø–æ—è–≤–∏—Ç—Å—è –∂–µ–ª–∞–Ω–∏–µ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞–¥–ø–∏—Å–∏ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ mobile. –ù–∞–∂–∏–º–∞–µ–º –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–Ω–æ–ø–æ—á–∫—É i –∏ –≤ –ø–æ—è–≤–∏–≤—à–µ–π—Å—è —Å–ª–µ–≤–∞ –ø–∞–Ω–µ–ª–∏ –≤—ã–±–∏—Ä–∞–µ–º –†–µ–∂. –∏–∑–º–µ–Ω–µ–Ω–∏–π. –î–∞–ª—å—à–µ –≤—Å—ë –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–æ.

## –ë–æ–Ω—É—Å: —Ä–∞–±–æ—Ç–∞ —á–µ–≥–æ-—Ç–æ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

–¢—É—Ç –≤—Å—ë –Ω–µ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ, –µ—Å–ª–∏ –≤—ã —É–º–µ–µ—Ç–µ —á–∏—Ç–∞—Ç—å –∫–æ–¥ –Ω–∞ JS.

ioBroker.javascript —É–º–µ–µ—Ç –≤ cron, –∑–∞ —Å–∏–º —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é, –∫–∞–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ—à–∏—Ç—å –æ–¥–Ω—É –∑–∞–¥–∞—á—É.

–ó–∞–¥–∞—á–∞: –¥–æ–º–∞ –µ—Å—Ç—å –≥–∞–∑–æ–≤—ã–π –∫–æ—Ç—ë–ª, —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π –∫–æ—Ç—ë–ª –∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π –≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å. –ì–∞–∑–æ–≤—ã–π –∫–æ—Ç—ë–ª –æ—Ç–ª–∏—á–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∏ —Å –æ—Ç–æ–ø–ª–µ–Ω–∏–µ–º, –∏ —Å –Ω–∞–≥—Ä–µ–≤–æ–º –≤–æ–¥—ã, –Ω–æ –Ω–∞–º —Å—Ç—Ä–∞—à–Ω–æ —Å–ø–∞—Ç—å —Å–æ –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –≥–∞–∑–æ–º. –ü–æ—ç—Ç–æ–º—É –Ω–∞–¥–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã —Å 22 –¥–æ 6 —á–∞—Å–æ–≤ –¥–æ–º –æ—Ç–∞–ø–ª–∏–≤–∞–ª—Å—è —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–º –∫–æ—Ç–ª–æ–º, –∞ –≤–æ–¥–∞ –Ω–∞–≥—Ä–µ–≤–∞–ª–∞—Å—å —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–º –≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–µ–º, –Ω–æ –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤–º–µ—Å—Ç–æ –Ω–∏—Ö —Ä–∞–±–æ—Ç–∞–ª –≥–∞–∑–æ–≤—ã–π –∫–æ—Ç—ë–ª, –±–ª–∞–≥–æ —É –Ω–µ–≥–æ —Ç–æ–ø–ª–∏–≤–æ –ø–æ–¥–µ—à–µ–≤–ª–µ.

–û–ø—Ä–µ–¥–µ–ª–∏–º—Å—è, —á—Ç–æ –º—ã –∏–º–µ–µ–º:

- –î–≤–∞ Sonoff Basic (Sonoff1, Sonoff2)
- –û–¥–∏–Ω Sonoff TH16 (Sonoff3)
- –°–µ–Ω—Å–æ—Ä —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ AM2301, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–π –∫ Sonoff TH16 (Sonoff3.Dht\_sonoff3)

–ü–æ–¥–∫–ª—é—á–∏–º Sonoff1 –∫ —Ä–µ–ª–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–∞–∑–æ–≤–æ–≥–æ –∫–æ—Ç–ª–∞, Sonoff2 - –∫ —Ä–µ–ª–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–∫–æ—Ç–ª–∞, –∞ Sonoff3 –∫ —Ä–µ–ª–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è. –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∫—Ä—É—Ç–∏–º –ø–æ –ì–û–°–¢—É - –ø–æ–ª—Ç–æ—Ä–∞ –º–µ—Ç—Ä–∞ –æ—Ç –ø–æ–ª–∞ –∏ –Ω–µ –º–µ–Ω–µ–µ –º–µ—Ç—Ä–∞ –æ—Ç –Ω–∞—Ä—É–∂–Ω–æ–π —Å—Ç–µ–Ω—ã –¥–æ–º–∞.

–¢–µ–ø–µ—Ä—å —Å–∫—Ä–∏–ø—Ç—É–µ–º. –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É –°–∫—Ä–∏–ø—Ç—ã –≤ ioBroker –∏ —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç. –ù–∞–∑–æ–≤—ë–º –µ–≥–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, gasheater\_autostart. –î–∞–ª—å—à–µ –∫–æ–¥, –∑–∞—Ç–µ–º —è –µ–≥–æ –Ω–µ–º–Ω–æ–≥–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É—é:

schedule(&quot;\* 6-21 \* \* \*&quot;, function () {

    var State\_relay1 = getState(&quot;mqtt.0.Sonoff1.Relay\_sonoff1.Relay&quot;).val;

    var State\_relay3 = getState(&quot;mqtt.0.Sonoff3.Relay\_sonoff3.Relay&quot;).val;

    var temp = getState(&quot;mqtt.0.Sonoff3.Dht\_sonoff3.Temperature&quot;).val;

    var maxTemp = 23;

    var minTemp = 22;

    if(temp &gt; maxTemp &amp;&amp; State\_relay1 === true) {

        log(&#39;–í—ã–∫–ª—é—á–∞–µ–º –≥–∞–∑–æ–≤—ã–π –∫–æ—Ç—ë–ª...&#39;);

        setState(&quot;mqtt.0.Sonoff1.Relay\_sonoff1.Relay&quot;, false);

    } else if(temp &lt; minTemp &amp;&amp; State\_relay1 === false) {

        log(&#39;–í–∫–ª—é—á–∞–µ–º –≥–∞–∑–æ–≤—ã–π –∫–æ—Ç—ë–ª...&#39;);

        setState(&quot;mqtt.0.Sonoff1.Relay\_sonoff1.Relay&quot;, true);

    }

    if(State\_relay3 === true) {

        log(&#39;–í—ã–∫–ª—é—á–∞–µ–º –≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å...&#39;);

        setState(&quot;mqtt.0.Sonoff3.Relay\_sonoff3.Relay&quot;, false);

    }

});

–ö–æ–¥ —É –Ω–∞—Å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å —Ñ—É–Ω–∫—Ü–∏–∏ schedule. –≠—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤ –¥—Ä–∞–π–≤–µ—Ä javascript —Ñ—É–Ω–∫—Ü–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cron –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ–¥–∞. –¢–æ, —á—Ç–æ —É –Ω–∞—Å –Ω–∞–ø–∏—Å–∞–Ω–æ, –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –≤ —Å–µ–¥—å–º–æ–º, –≤–æ—Å—å–º–æ–º, –¥–µ–≤—è—Ç–æ–º –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ —á–∞—Å—É. –î–∞–ª—å—à–µ –≤ –æ–±—ë—Ä—Ç–∫–µ –∏–¥—ë—Ç –∫–æ–¥, –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≤–∫–ª—é—á–µ–Ω–∏—è –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—è –≥–∞–∑–æ–≤–æ–≥–æ –∫–æ—Ç–ª–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–µ–≥–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –º–µ–∂–¥—É 22 –∏ 23 –≥—Ä–∞–¥—É—Å–∞–º–∏ –ø–æ —à–∫–∞–ª–µ –¶–µ–ª—å—Å–∏—è. –¢–∞–∫–∂–µ –∫–æ–¥ –≤—ã–∫–ª—é—á–∞–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ–≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å –Ω–∞ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –≥–∞–∑–æ–≤–æ–≥–æ –∫–æ—Ç–ª–∞.

–ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–¥–µ–ª–∏—Ç—å –ø–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ schedule –≤–º–µ—Å—Ç–µ —Å –∫–∞–≤—ã—á–∫–∞–º–∏ –∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É Cron –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É –≤–∫–ª–∞–¥–∫–∏.

–¢–µ–ø–µ—Ä—å —Å–¥–µ–ª–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–æ—á—å—é —Ä–∞–±–æ—Ç–∞–ª —ç–ª–µ–∫—Ç—Ä–æ–∫–æ—Ç—ë–ª –∏ –≤–∫–ª—é—á–∞–ª—Å—è —ç–ª–µ–∫—Ç—Ä–æ–≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å. –°–æ–∑–¥–∞—ë–º –µ—â—ë –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç, –Ω–∞–∑—ã–≤–∞–µ–º –µ–≥–æ electroheater\_autostart –∏ –∫–æ–ø–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

schedule(&quot;\* 0-5,22,23 \* \* \*&quot;, function () {

    var State\_relay2 = getState(&quot;mqtt.0.Sonoff2.Relay\_sonoff2.Relay&quot;).val;

    var State\_relay3 = getState(&quot;mqtt.0.Sonoff3.Relay\_sonoff3.Relay&quot;).val;

    var temp = getState(&quot;mqtt.0.Sonoff3.Dht\_sonoff3.Temperature&quot;).val;

    var maxTemp = 23;

    var minTemp = 22;

    if(temp &gt; maxTemp &amp;&amp; State\_relay === true) {

        log(&#39;–í—ã–∫–ª—é—á–∞–µ–º —ç–ª–µ–∫—Ç—Ä–æ–∫–æ—Ç—ë–ª...&#39;);

        setState(&quot;mqtt.0.Sonoff2.Relay\_sonoff2.Relay&quot;, false);

    } else if(temp &lt; minTemp &amp;&amp; State\_relay === false) {

        log(&#39;–í–∫–ª—é—á–∞–µ–º —ç–ª–µ–∫—Ç—Ä–æ–∫–æ—Ç—ë–ª...&#39;);

        setState(&quot;mqtt.0.Sonoff2.Relay\_sonoff2.Relay&quot;, true);

    }

    if(State\_relay3 === false) {

        log(&#39;–í–∫–ª—é—á–∞–µ–º –≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å...&#39;);

        setState(&quot;mqtt.0.Sonoff3.Relay\_sonoff3.Relay&quot;, true);

    }

});

–ó–¥–µ—Å—å —É –Ω–∞—Å –≤—Å—ë –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ, —Å —Ä–∞–∑–Ω–∏—Ü–µ–π –≤ —Ç–æ–º, —á—Ç–æ –º—ã –≤–∫–ª—é—á–∞–µ–º –∏ –≤—ã–∫–ª—é—á–∞–µ–º –¥—Ä—É–≥–æ–π Sonoff –∏ —É–∫–∞–∑–∞–Ω–æ –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è –¥–ª—è —Ä–∞–±–æ—Ç—ã.

–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è!
