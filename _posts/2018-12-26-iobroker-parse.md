---
layout: post
title: "–ü–∞—Ä—Å–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã "
date:   2018-12-26
description: "ioBroker —Å–∫—Ä–∏–ø—Ç —á–∞—Å—Ç—å.1"
categories: ioBroker
main-class: 'iobroker'
color: '#EB7728'
tags:
- iobroker
- iob
- –∏–æ–±—Ä–æ–∫–µ—Ä
- –∏–æ–±
- script
- jscript 
excerpt:
introduction: "üåû –°–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ–≥–æ–¥—ã."
---

# ioBroker —Å–∫—Ä–∏–ø—Ç —á–∞—Å—Ç—å.1

   **–ü—Ä–µ–∞–º–±—É–ª–∞.**

–ù–∞—á–∞–ª–æ—Å—å –≤—Å–µ —Å —Ç–æ–≥–æ —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä–∞ **yr.no –ø–æ–≥–æ–¥–∞** –ø–µ—Ä–µ—Å—Ç–∞–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—É—é –ø–æ–≥–æ–¥—É, —á—Ç–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∏ —Å—Ç–∞–ª–æ
–ø—Ä–∏—á–∏–Ω–æ–π –Ω–∞–ø–∏—Å–∞–Ω–∏—è –¥–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞. 

### –ù–∞—á–∞–ª–æ.

–ü—Ä–µ–∂–¥–µ —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥—Ä–∞–π–≤–µ—Ä–∞ **JavaScript** , –ø–∞—Ä—É –º–æ–¥—É–ª–µ–π, —ç—Ç–æ:
 
[cheerio][1] - –±—ã—Å—Ç—Ä—ã–π –∏ –≥–∏–±–∫–∏–π –ø–∞—Ä—Å–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ jQuery.

[iconv-lite][2]-–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∫–æ–¥–∏—Ä–æ–≤–æ–∫.

–ú–æ–∂–Ω–æ –±—ã–ª–æ –æ–±–æ–π—Ç–∏—Å—å –∏ –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ –Ω–æ —Ä—É—Å—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –ø—Ä–∏–ª–µ—Ç–∞–ª–∏ –∫—Ä–∞–∫–æ–∑—è–±—Ä–∞–º–∏.

–ù–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ —ç—Ç–æ –±—É–¥–µ—Ç —Ç–∞–∫...

![][6] 

–¢–∞–∫ –∫–∞–∫  –∫–æ–¥–µ—Ä —è –Ω–∞—á–∏–Ω–∞—é—â–∏–π, –∏ –º–Ω–µ –ø–æ–Ω—è—Ç–Ω–µ–µ –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö —á—Ç–æ –∏ –∫—É–¥–∞, –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–º–µ—Ä –∫–∞–∫ –Ω–∞–π—Ç–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∫–æ–¥.

>**–ü—Ä–∏–º–µ—Ä:** –ó–∞—Ö–æ–¥–∏–º –Ω–∞ **gist.github.com**<br>
>–í –ø–æ–∏—Å–∫–µ –ø–∏—à–µ–º **iconv-lite**

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–∏—Å–∫–∞ —ç—Ç–æ—Ç [jscript][3] , –∫–æ—Ç–æ—Ä—ã–π –∏ —Å—Ç–∞–ª –±–∞–∑–æ–π –¥–ª—è –Ω–∞—à–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞.


–ê —ç—Ç–æ –Ω–∞—à–∞ –∂–µ—Ä—Ç–≤–∞ **meteovesti.ru/pogoda_5/34214**, –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –∫—Ä–∞—Å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–ø–∏—Å–∞–Ω–Ω—ã –≤ –æ–±—ä–µ–∫—Ç—ã.

![][4] 


### –°–∞–º —Å–∫—Ä–∏–ø—Ç:

{% highlight javascript %}
createState('javascript.0.cast.temp', 0);//—Å–æ–∑–¥–∞–µ–º –æ–±—å–µ–∫—Ç—ã –≤ –ø–∞–ø–∫–µ javascript.0=>cast —Å –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ 0
createState('javascript.0.cast.date', 0);
createState('javascript.0.cast.temp1', 0);
createState('javascript.0.cast.date1', 0);
schedule('*/30 * * * *', function () {//–∫—Ä–æ–Ω, –ø–∞—Ä—Å–∏–º –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
var request = require("request");
var cheerio = require('cheerio');
var iconv  = require('iconv-lite');
var Dat,Temp,Dat1,Temp1
 
var requestOptions  = { method: "post"
                ,uri: "http://www.meteovesti.ru/pogoda_5/34214"//—Å–∞–π—Ç –ø–æ–≥–æ–¥—ã –æ—Ç–∫—É–¥–∞ –ø–∞—Ä—Å–∏–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –∏ –¥–∞—Ç—É
                ,headers: { "User-Agent": "Mozilla/5.0" }
                ,encoding: null
            };

// request 
request(requestOptions, function(error, response, body) {
  // –ø–æ —Ä—É–∑–∫–∏
  var strContents = new Buffer(body);
  var $ = cheerio.load(iconv.decode(strContents, 'windows-1251').toString());//–ø–µ—Ä–µ–≤–æ–¥–∏–º –∫—Ä–∞–∫–æ–∑—è–±—Ä—ã –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥
  Dat = $('td .wpdate').eq(0).text();
  Temp = $('td .wptemp').eq(0).text();
  Dat1 = $('td .wpdate').eq(1).text();
  Temp1 = $('td .wptemp').eq(1).text();
  setState('javascript.0.cast.temp', Temp);//–∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Å–ø–∞—Ä—Å–µ–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–±—ä–µ–∫—Ç
  setState('javascript.0.cast.date', Dat);
  setState('javascript.0.cast.temp1', Temp1);
  setState('javascript.0.cast.date1', Dat1);
  //console.log(Dat); 
  //console.log(Temp);
 });
});
{% endhighlight %}

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ.

–ó–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–ª–µ—Ç–µ–ª–∏ –≤ –æ–±—ä–µ–∫—Ç—ã, —á—Ç–æ –¥–∞–ª—å—à–µ –º–æ–∂–Ω–æ —Å –Ω–∏–º–∏ –¥–µ–ª–∞—Ç—å...

![][5] 

[1]: https://github.com/cheeriojs/cheerio
[2]: https://github.com/ashtuchkin/iconv-lite
[3]: https://gist.github.com/developer-sdk/a70bbf570d36e119c4853bedcfdd29f3
[4]: /assets/image/salam/weather.png
[5]: /assets/image/salam/weather_obj.png
[6]: /assets/image/salam/parser_lib.png




